!function(t,e){"function"==typeof define&&define.amd?define("image-zooming",["$"],e):"object"==typeof exports?module.exports=e():t.ImageZooming=e(window.Zepto||window.jQuery||$)}(this,function(t){function e(){var t=Math.random().toString().replace(".","");this.id="imagezooming_"+t}return t.fn.ImageZooming=function(i){var o=[];return t(this).each(function(){var s=t.extend({target:t(this)},i),n=new e;n.init(s),o.push(n)}),o},e.prototype={init:function(e){this.settings=t.extend({target:t(),width:100,height:100,always:!1,times:2,callback:null},e),this.settings.target=t(this.settings.target),this.zoom=t("#"+this.id),this.bindEvent()},bindEvent:function(){var e=this;if(this.settings.always){e.createZooming.call(e,this.settings.target);var i=this.settings.target,o=t(i).offset();t(i).height(),t(i).width(),e.setPosition.call(e,i.width()/2+o.left,i.height()/2+o.top,i)}e.zoom.on("touchmove",function(t){return e.event.zoommove.call(this,t,e)});var s=!1;e.zoom.on("mousedown",function(t){s=!0}),t("body").on("mouseup","#"+e.id,function(t){return s=!1,e.event.mouseup.call(this,t,e)}),t("body").on("mousemove","#"+e.id,function(t){return s&&e.event.zoommove.call(this,t,e)}),t(this.settings.target).on("touchstart",function(t){e.event.mousedown.call(this,t,e)}),t(this.settings.target).on("mousedown",function(t){e.event.mousedown.call(this,t,e),s=!0}),t(this.settings.target).on("touchmove",function(t){return e.event.mousemove.call(this,t,e)}),t(this.settings.target).on("mousemove",function(t){return s&&e.event.mousemove.call(this,t,e)}),t(this.settings.target).on("touchend",function(t){return e.event.mouseup.call(this,t,e)}),t(this.settings.target).on("mouseup",function(t){return e.event.mouseup.call(this,t,e)})},event:{zoommove:function(t,e){var i=t.changedTouches?t.changedTouches[0]:t;return e.setPosition.call(e,i.pageX,i.pageY,e.settings.target),!1},mousedown:function(t,e){var i=t.changedTouches?t.changedTouches[0]:t;e.createZooming.call(e,this),e.setPosition.call(e,i.pageX,i.pageY,this)},mousemove:function(t,e){var i=t.changedTouches?t.changedTouches[0]:t;return e.setPosition.call(e,i.pageX,i.pageY,this),!1},mouseup:function(t,e){return e.removeZooming(),!1}},removeZooming:function(){this.settings.always||this.zoom.hide()},createZooming:function(e){0===this.zoom.size()&&(this.zoom=t('<div id="'+this.id+'" style="position:absolute;background:none;"/>'),t("body").append(this.zoom),this.zoom.height(this.settings.height),this.zoom.width(this.settings.width),this.zoom.css({background:"url("+t(e).attr("src")+") no-repeat ",borderRadius:this.settings.width+"px "+this.settings.height+"px",border:"1px solid #ccc"})),this.zoom.show()},setPosition:function(e,i,o){var s=t(o).offset(),n=t(o).height(),h=t(o).width();e=Math.min(e,s.left+h),e=Math.max(e,s.left),i=Math.min(i,s.top+n),i=Math.max(i,s.top);var a={x:e-this.settings.width/2,y:i-this.settings.height/2},g={x:h*this.settings.times,y:n*this.settings.times},u={x:(e-s.left)*this.settings.times-this.settings.width/2,y:(i-s.top)*this.settings.times-this.settings.height/2};this.zoom.css({left:a.x,top:a.y,backgroundPosition:-u.x+"px "+-u.y+"px",backgroundSize:g.x+"px "+g.y+"px"}),this.settings.callback&&this.settings.callback(a,u,g,o,this.zoom)}},e});